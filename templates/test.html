<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>Title</title>
        <style>
            .flex {
                display: flex;
            }

            .strength-fields {
                column-gap: 10px;
            }

            .strength-field {
                width: 30px;
                height: 5px;
                background-color: gray;
                transition: 0.5s;
            }

        </style>
    </head>
    <body>
        <form>
            <input type="text">
            <div class="strength-fields" style="display: flex">
                <div class="strength-field" style="background-color: gray"></div>
                <div class="strength-field" style="background-color: gray"></div>
                <div class="strength-field" style="background-color: gray"></div>
                <div class="strength-field" style="background-color: gray"></div>
            </div>
        </form>
        <script>
            document.querySelector("input").addEventListener("input", (event) => {
                console.log(document.querySelector("input").value);
                checkPasswordStrength(document.querySelector("input").value)
            })

            function matchPasswordChar(userInput) {
                // Array.from(userInput.match(/[A-Z]/g)).length
                const regexList = [/[A-Z]/g, /[a-z]/g, /[\d]/g, /[!@#$%^&*(),.?":{}|<>_\-+=~`[\]\\/'\\;]/g];
                const maxNums = [2, 3, 2, 1]
                let numOfMatches = [];
                for (let i = 0; i < regexList.length; i++) {
                    const matches = userInput.match(regexList[i])
                    const maxNum = maxNums[i]
                    if (matches !== null) {
                       if (matches.length <= maxNum) {
                         numOfMatches.push(matches.length)
                       } else {
                         numOfMatches.push(maxNum)
                       }
                    } else {
                        numOfMatches.push(0);
                    }
                }
                console.log(numOfMatches)
                return numOfMatches
            }

            const makePasswordBars = (colors) => {
                return `<div class="strength-field" style="background-color: ${colors[0]}"></div>
                        <div class="strength-field" style="background-color: ${colors[1]}"></div>
                        <div class="strength-field" style="background-color: ${colors[2]}"></div>
                        <div class="strength-field" style="background-color: ${colors[3]}"></div>`
            }

            function checkPasswordStrength(userInput) {
                const totalMatchNum = matchPasswordChar(userInput).reduce((sum, matchNum) => sum += matchNum);
                const strengthField = document.querySelector(".strength-fields");

                if (totalMatchNum > 6) {
                   strengthField.innerHTML = makePasswordBars(["green", "green", "green", "green"]);
                } else if (totalMatchNum > 4) {
                    strengthField.innerHTML = makePasswordBars(["orange", "orange", "orange", "gray"]);
                } else if (totalMatchNum > 2) {
                    strengthField.innerHTML = makePasswordBars(["yellow", "yellow", "gray", "gray"]);
                } else if (totalMatchNum > 0) {
                    strengthField.innerHTML = makePasswordBars(["red", "gray", "gray", "gray"]);
                } else {
                    strengthField.innerHTML = makePasswordBars(["gray", "gray", "gray", "gray"]);
                }
            }


            //console.log(Array.from(userInput.match(/[A-Z]/g)).length)
            // console.log(/^[-.]|[.-]$|[:,]|([+])\1|.(?<=-)|.(?=-)/.test(userInput));

            function invalidEmail(regex, emailSegment) {
              return regex.test(emailSegment);
            }

            // console.log(invalidEmail(/^[.-_!#$%&'*+/=?^`{|}~]|[.-_!#$%&'*+/=?^`{|}~]$|[\\,":;<>[\]()]|[-_!\.#$%&'*+/=?^`{|}~]{2}/g, "maddickinson6"))
            // console.log(invalidEmail(/^[-.]|[-.]$|[^a-zA-Z0-9-.]|[.-]{2}/, userInput), userInput)

            const charCounter = (char) => userInput.split(char).length - 1;

            function atError() {
                if (charCounter("@") > 1) {
                  return true;
                }

                return userInput.includes("@") != true;
            }


            function hasUnallowedChars(string, unallowedChars) {
                for (const char of unallowedChars) {
                    if (string.includes(char)) {
                        return true;
                    }
                }
            }

            function hasBeginningEndChar(string, allowedChars) {
                for (const char of allowedChars) {
                    if (char === string[0] || char === string[string.length - 1]) {
                      return true;
                    }
                }
            }

            const emailUsernameIsNotValid = (userPart) => {
              // User Metrics;
              const userPartDisallowedChars = [' ', '"', '\\', ',', ':', ';', '<', '>', '[', ']', '(', ')', '@'];
              const restrictedUserPartBeginEndChars = ['.', '-', '_', '!', '#', '$', '%', '&', "'", '*', '+', '/', '=', '?', '^', '`', '{', '|', '}', '~'];
              const restrictedUserPartDoubleChars = restrictedUserPartBeginEndChars.map((item) => `${item}${item}`)

              if (hasUnallowedChars(userPart, userPartDisallowedChars)) {
                return true;
              } else if (hasUnallowedChars(userPart, restrictedUserPartDoubleChars)){
                return true;
              } else if (hasBeginningEndChar(userPart, restrictedUserPartBeginEndChars)) {
                return true;
              }

              return false;
            }

            const emailDomainIsNotValid = (domainPart) => {
              // Domain Metrics
              const domainPartDisallowedChars = [' ', '"', '\\', ',', ':', ';', '<', '>', '[', ']', '(', ')', '@', '_', '/'];
              const restrictedDomainBeginEndChars = ['-', '.'];
              const restrictedDomainPartDoubleChars = restrictedDomainBeginEndChars.map((item) => `${item}${item}`)

              if (hasUnallowedChars(domainPart, domainPartDisallowedChars)) {
                return true;
              } else if (hasUnallowedChars(domainPart, restrictedDomainPartDoubleChars)) {
                return true;
              } else if (hasBeginningEndChar(domainPart, restrictedDomainBeginEndChars)) {
                return true;
              }

              return false;
            }

            const emailHasNoDomainOrUsername = () => {
                return splitUserInput[0].length > 0 && splitUserInput[1].length > 0 ? true : false;
            }

            // const emailDomain
        </script>
    </body>
</html>